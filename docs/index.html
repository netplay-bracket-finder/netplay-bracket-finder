<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>upcoming melee</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
        <script type="text/javascript" src="https://cdn.datatables.net/v/dt/jq-3.6.0/dt-1.12.1/datatables.min.js"></script>
        <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/dt/dt-1.12.1/datatables.min.css"/>
        <style>
         tr {
             position: relative;
             background-origin: border-box;
             background-size: cover;
             background-repeat: repeat;
             background-position: center center;
         }
        </style>
        <script type="text/javascript">
        $(document).ready(() => {
            $('#tournaments').DataTable({
                ajax: {
                    url: "/events.json",
                    dataSrc: ""
                },
                // data: dataSet,
                rowCallback: ( row, data ) => {
                    $(row).css({
                        "background-image": `linear-gradient(to right, rgba(255,255,255, 0.97) 0 100%), url('${data.image}')`,
                    });
                },
                columns: [
                    { data: 'tournament_name',
                      title: 'tournament',
                      render: (data, datatype, row) => {
                          return `<a href="https://start.gg/${row.slug}" >${data}</a>`;
                      }
                    },
                    { data: 'event_name',
                      title: 'event',
                      render: (data, datatype, row) => {
                          return `<a href="https://start.gg/${row.slug}" >${data}</a></div>`;
                      }
                    },
                    { data: 'entrants', title: 'entrants' },
                    { data: 'start_time',
                      title: 'start time',
                      render: (data, datatype) => {
                          let start = new Date(data * 1000);
                          let options = {
                              year: 'numeric', month: 'numeric', day: 'numeric',
                              hour: 'numeric', minute: 'numeric', second: 'numeric',
                          };
                          return (new Intl.DateTimeFormat('en-US', options).format(start));
                      }
                    },
                ],
            });
        });
        </script>
    </head>
    <body>
        <div class="container">
            <section class="hero is-small is-primary">
              <div class="hero-body">
                <p class="title">upcoming melee netplay tournaments</p>
                <p class="subtitle">scraped from start.gg every 15min</p>
              </div>
            </section>
            <section class="section">
                <div class="notification is-danger is-light">
                  under construction! not finished! (oct 1st 2022)
                </div>
                <table id="tournaments" class="display"></table>
            </section>
            <footer class="footer">
              <div class="content has-text-centered">
                built by <a href="https://github.com/djanatyn">DJAN</a> with <a href="https://bulma.io">bulma</bulma>, <a href="https://www.datatables.net/">DataTables</a>, <a href="https://docs.rs/ureq/latest/ureq/">ureq</a>, <a href="https://serde.rs">serde</a>, <a href="https://pages.github.com/">github pages</a>
              </div>
            </footer>
        </div>
    </body>
</html>
